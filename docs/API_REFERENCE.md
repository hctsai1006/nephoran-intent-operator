# Nephoran Intent Operator API Reference

## Overview

The Nephoran Intent Operator provides a set of Custom Resource Definitions (CRDs) that enable natural language-driven network automation and O-RAN compliant deployments. This document describes the API specifications, resource definitions, and usage examples for all available resources.

## API Group Information

- **API Group**: `nephoran.com`
- **API Version**: `v1`
- **Full API Version**: `nephoran.com/v1`

## Resources

### 1. NetworkIntent

The NetworkIntent resource allows users to express network automation requirements in natural language, which are then processed by the LLM-enhanced controller to generate structured network configurations.

#### API Specification

```yaml
apiVersion: nephoran.com/v1
kind: NetworkIntent
metadata:
  name: <intent-name>
  namespace: <namespace>
spec:
  intent: <natural-language-description>
  parameters: <structured-parameters>  # Optional, auto-generated by LLM processor
status:
  conditions: []
  phase: <processing-phase>
  processingStartTime: <timestamp>
  processingCompletionTime: <timestamp>
  deploymentStartTime: <timestamp>
  deploymentCompletionTime: <timestamp>
  gitCommitHash: <commit-hash>
  lastRetryTime: <timestamp>
  observedGeneration: <generation-number>
```

#### Field Descriptions

**Spec Fields:**
- `intent` (string, required): Natural language description of the desired network configuration or automation task
- `parameters` (object, optional): Structured parameters generated by the LLM processor from the natural language intent

**Status Fields:**
- `conditions` (array): Standard Kubernetes conditions array indicating resource state
- `phase` (string): Current processing phase (e.g., "Processing", "Deployed", "Failed")
- `processingStartTime` (timestamp): When intent processing began
- `processingCompletionTime` (timestamp): When intent processing completed
- `deploymentStartTime` (timestamp): When GitOps deployment started
- `deploymentCompletionTime` (timestamp): When GitOps deployment completed
- `gitCommitHash` (string): Commit hash of the deployed configuration
- `lastRetryTime` (timestamp): Last retry attempt timestamp
- `observedGeneration` (int64): Generation of the most recently observed resource

#### Usage Examples

**Basic Network Configuration Intent:**
```yaml
apiVersion: nephoran.com/v1
kind: NetworkIntent
metadata:
  name: configure-5g-network
  namespace: default
  labels:
    app.kubernetes.io/name: networkintent
    app.kubernetes.io/instance: configure-5g-network
spec:
  intent: "Configure a 5G network slice for IoT devices with low latency requirements. Set up bandwidth allocation of 100 Mbps, enable QoS with priority level 5, and configure network isolation for security."
```

**Edge Computing Setup Intent:**
```yaml
apiVersion: nephoran.com/v1
kind: NetworkIntent
metadata:
  name: setup-edge-computing
  namespace: default
spec:
  intent: "Deploy edge computing resources for real-time video processing. Configure compute nodes with GPU acceleration, set up container orchestration, and enable low-latency networking between edge nodes and central cloud."
```

**Network Security Policies Intent:**
```yaml
apiVersion: nephoran.com/v1
kind: NetworkIntent
metadata:
  name: configure-network-policies
  namespace: telecom
spec:
  intent: "Set up network security policies for a multi-tenant telecom environment. Create namespace isolation, configure ingress/egress rules, and enable network monitoring for compliance."
```

#### API Operations

**Create NetworkIntent:**
```bash
kubectl apply -f networkintent.yaml
```

**Get NetworkIntent:**
```bash
kubectl get networkintent <name> -n <namespace>
kubectl get networkintent <name> -n <namespace> -o yaml
```

**List NetworkIntents:**
```bash
kubectl get networkintents -n <namespace>
kubectl get networkintents --all-namespaces
```

**Check Status:**
```bash
kubectl describe networkintent <name> -n <namespace>
kubectl get networkintent <name> -n <namespace> -o jsonpath='{.status.phase}'
```

**Delete NetworkIntent:**
```bash
kubectl delete networkintent <name> -n <namespace>
```

### 2. E2NodeSet

The E2NodeSet resource manages collections of simulated E2 nodes for O-RAN testing and development. It provides replica-based scaling of E2 node simulations.

#### API Specification

```yaml
apiVersion: nephoran.com/v1
kind: E2NodeSet
metadata:
  name: <nodeset-name>
  namespace: <namespace>
spec:
  replicas: <number-of-nodes>
status:
  readyReplicas: <ready-node-count>
```

#### Field Descriptions

**Spec Fields:**
- `replicas` (int32, required): Number of simulated E2 nodes to run (minimum: 0)

**Status Fields:**
- `readyReplicas` (int32): Number of E2 nodes that are currently ready and operational

#### Validation Rules

- `replicas`: Must be >= 0 (enforced by kubebuilder validation)

#### Usage Examples

**Basic E2NodeSet:**
```yaml
apiVersion: nephoran.com/v1
kind: E2NodeSet
metadata:
  name: sample-e2nodeset
  namespace: default
spec:
  replicas: 3
```

**Scaled E2NodeSet:**
```yaml
apiVersion: nephoran.com/v1
kind: E2NodeSet
metadata:
  name: scaled-e2nodeset
  namespace: default
spec:
  replicas: 5
```

#### API Operations

**Create E2NodeSet:**
```bash
kubectl apply -f e2nodeset.yaml
```

**Get E2NodeSet:**
```bash
kubectl get e2nodeset <name> -n <namespace>
kubectl get e2nodeset <name> -n <namespace> -o yaml
```

**Scale E2NodeSet:**
```bash
kubectl patch e2nodeset <name> -n <namespace> -p '{"spec":{"replicas":5}}'
kubectl scale e2nodeset <name> --replicas=5 -n <namespace>
```

**Check Ready Status:**
```bash
kubectl get e2nodeset <name> -n <namespace> -o jsonpath='{.status.readyReplicas}'
```

**Delete E2NodeSet:**
```bash
kubectl delete e2nodeset <name> -n <namespace>
```

### 3. ManagedElement

The ManagedElement resource represents O-RAN network elements with their associated configurations, policies, and management interfaces.

#### API Specification

```yaml
apiVersion: nephoran.com/v1
kind: ManagedElement
metadata:
  name: <element-name>
  namespace: <namespace>
spec:
  deploymentName: <deployment-reference>
  o1Config: <o1-configuration>     # Optional
  a1Policy: <a1-policy-data>       # Optional
  e2Configuration: <e2-config>     # Optional
status:
  conditions: []
```

#### Field Descriptions

**Spec Fields:**
- `deploymentName` (string, required): Reference to the Kubernetes deployment name
- `o1Config` (string, optional): O1 interface configuration for FCAPS management
- `a1Policy` (object, optional): A1 interface policy configuration (preserves unknown fields)
- `e2Configuration` (object, optional): E2 interface configuration (preserves unknown fields)

**Status Fields:**
- `conditions` (array): Standard Kubernetes conditions array indicating element state

#### Usage Examples

**Basic ManagedElement:**
```yaml
apiVersion: nephoran.com/v1
kind: ManagedElement
metadata:
  name: amf-element
  namespace: telecom-core
spec:
  deploymentName: "amf-deployment"
  o1Config: |
    management:
      endpoint: "https://amf.telecom-core.svc.cluster.local:8080"
      protocol: "NETCONF"
```

**Advanced ManagedElement with Policies:**
```yaml
apiVersion: nephoran.com/v1
kind: ManagedElement
metadata:
  name: cu-element
  namespace: ran
spec:
  deploymentName: "cu-deployment"
  o1Config: |
    management:
      endpoint: "https://cu.ran.svc.cluster.local:8080"
      fcaps:
        fault_management: true
        performance_management: true
  a1Policy:
    policyTypeId: "1000"
    policyData:
      qosParameters:
        latency: "10ms"
        throughput: "1Gbps"
  e2Configuration:
    ricAddress: "10.0.1.100:36421"
    connectionType: "sctp"
```

#### API Operations

**Create ManagedElement:**
```bash
kubectl apply -f managedelement.yaml
```

**Get ManagedElement:**
```bash
kubectl get managedelement <name> -n <namespace>
kubectl get managedelement <name> -n <namespace> -o yaml
```

**List ManagedElements:**
```bash
kubectl get managedelements -n <namespace>
kubectl get managedelements --all-namespaces
```

**Update Configuration:**
```bash
kubectl patch managedelement <name> -n <namespace> --type merge -p '{"spec":{"o1Config":"new-config"}}'
```

**Delete ManagedElement:**
```bash
kubectl delete managedelement <name> -n <namespace>
```

## Common API Patterns

### Resource Naming Conventions

- Use lowercase alphanumeric characters and hyphens
- Names should be descriptive and include the function or role
- Examples: `amf-core-element`, `edge-computing-intent`, `test-e2nodeset`

### Namespace Organization

- Use namespaces to organize resources by function or environment
- Common namespaces: `telecom-core`, `ran`, `edge`, `monitoring`
- Development/testing: `dev`, `test`, `staging`

### Labels and Annotations

**Recommended Labels:**
```yaml
metadata:
  labels:
    app.kubernetes.io/name: <resource-type>
    app.kubernetes.io/instance: <resource-name>
    app.kubernetes.io/component: <component-name>
    app.kubernetes.io/part-of: nephoran-intent-operator
    environment: <env-name>
```

**Useful Annotations:**
```yaml
metadata:
  annotations:
    nephoran.com/description: "Human readable description"
    nephoran.com/created-by: "operator-name"
    nephoran.com/last-updated: "2025-08-03T12:00:00Z"
```

### Status Monitoring

**Check Resource Status:**
```bash
# Check overall status
kubectl get <resource-type> <name> -n <namespace> -o wide

# Get detailed status information
kubectl describe <resource-type> <name> -n <namespace>

# Watch for changes
kubectl get <resource-type> <name> -n <namespace> -w
```

**Common Status Conditions:**
- `Ready`: Resource is operational
- `Progressing`: Resource is being processed
- `Degraded`: Resource has issues but is partially functional
- `Failed`: Resource processing failed

## Error Handling and Troubleshooting

### Common Error Scenarios

**Invalid Intent Format:**
```yaml
# Problem: Empty or invalid intent
spec:
  intent: ""  # This will cause validation errors
```

**Solution:** Provide a meaningful natural language description:
```yaml
spec:
  intent: "Deploy a secure 5G core network with AMF and SMF components"
```

**Resource Not Found:**
```bash
# Error: the server could not find the requested resource
kubectl get networkintent test-intent
```

**Solution:** Check if CRDs are installed:
```bash
kubectl get crd | grep nephoran.com
kubectl api-resources | grep nephoran
```

**Processing Failures:**
Check the controller logs:
```bash
kubectl logs -n nephoran-system deployment/nephio-bridge
kubectl logs -n nephoran-system deployment/llm-processor
```

### Best Practices

1. **Intent Clarity**: Write clear, specific natural language intents
2. **Resource Naming**: Use descriptive names that indicate purpose
3. **Namespace Usage**: Organize resources logically across namespaces
4. **Status Monitoring**: Regularly check resource status and conditions
5. **Cleanup**: Remove unused resources to avoid cluster bloat

## API Versioning

The Nephoran Intent Operator follows Kubernetes API versioning conventions:

- **v1**: Stable API suitable for production use
- **v1alpha1**: Alpha versions for experimental features (deprecated, migrated to v1)
- **v1beta1**: Beta versions for pre-release features

Current stable version: `nephoran.com/v1`

## Integration Examples

### Complete Workflow Example

```bash
# 1. Create a NetworkIntent
cat <<EOF | kubectl apply -f -
apiVersion: nephoran.com/v1
kind: NetworkIntent
metadata:
  name: deploy-5g-core
  namespace: telecom
spec:
  intent: "Deploy a complete 5G core network with AMF, SMF, and UPF functions. Configure for high availability with 3 replicas each and enable monitoring."
EOF

# 2. Monitor processing
kubectl get networkintent deploy-5g-core -n telecom -w

# 3. Create supporting E2 nodes
cat <<EOF | kubectl apply -f -
apiVersion: nephoran.com/v1
kind: E2NodeSet
metadata:
  name: core-e2nodes
  namespace: telecom
spec:
  replicas: 3
EOF

# 4. Set up managed elements
cat <<EOF | kubectl apply -f -
apiVersion: nephoran.com/v1
kind: ManagedElement
metadata:
  name: amf-mgmt
  namespace: telecom
spec:
  deploymentName: "amf-deployment"
  o1Config: |
    management:
      endpoint: "https://amf.telecom.svc.cluster.local:8080"
EOF

# 5. Check overall status
kubectl get networkintents,e2nodesets,managedelements -n telecom
```

This API reference provides comprehensive coverage of all Nephoran Intent Operator resources, their specifications, and practical usage examples for effective network automation and O-RAN management.